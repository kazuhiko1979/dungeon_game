# 仕様書: 2Dダンジョンクローラーゲーム

## プロジェクト概要
このプロジェクトは、PythonとPygameを使用して開発された2Dダンジョンクローラーゲームです。プレイヤーはキャラクターを操作し、敵を倒したり、アイテムを収集したりしながらダンジョンを探索します。ゲームにはスコアシステム、ライフシステム、武器システム、アニメーション、レベルデータの読み込み機能が含まれています。

---

## 機能一覧

### 1. プレイヤーキャラクター
- **クラス**: `Character`
- **機能**:
  - プレイヤーの移動（上下左右）。
  - アニメーション（"idle", "run"）の切り替え。
  - スコアとライフの管理。
  - 敵やアイテムとの衝突判定。
  - 描画処理。

### 2. 敵キャラクター
- **クラス**: `Character`
- **機能**:
  - 敵のアニメーション。
  - AIによる移動。
  - プレイヤーとの衝突判定。

### 3. 武器システム
- **クラス**: `Weapon`
- **機能**:
  - 弓と矢の描画。
  - 矢の発射と敵へのダメージ処理。

### 4. アイテムシステム
- **クラス**: `Item`
- **機能**:
  - アイテムの種類（コイン、ポーション）。
  - プレイヤーがアイテムを収集した際の効果（スコア増加、ライフ回復）。
  - アニメーション処理。

### 5. レベルデータ
- **ファイル**: `levels/levelX_data.csv`
- **機能**:
  - CSVファイルからタイルマップデータを読み込み、ゲームワールドを生成。
  - タイル画像のスケーリングと描画。

### 6. UIシステム
- **機能**:
  - プレイヤーのライフをハートアイコンで表示。
  - 現在のスコアとレベルを画面上部に表示。

### 7. サウンド
- **ファイル**: `assets/audio`
- **機能**:
  - 矢の発射音、敵へのヒット音、アイテム収集音、BGMの再生。

### 8. ゲームループ
- **ファイル**: `main.py`
- **機能**:
  - メインゲームループでフレームレートを維持。
  - プレイヤー、敵、アイテム、武器の更新と描画。
  - キーボード入力の処理。

---

## ディレクトリ構造

/ ├── main.py # メインゲームロジック ├── character.py # キャラクタークラス ├── weapon.py # 武器クラス ├── items.py # アイテムクラス ├── constants.py # 定数定義 ├── world.py # ワールド生成ロジック ├── assets/ # アセットフォルダ │ ├── audio/ # サウンドファイル │ ├── fonts/ # フォントファイル │ ├── images/ # 画像ファイル │ ├── buttons/ # ボタン画像 │ ├── characters/ # キャラクター画像 │ ├── items/ # アイテム画像 │ ├── tiles/ # タイル画像 │ ├── weapons/ # 武器画像 ├── levels/ # レベルデータ │ ├── level1_data.csv # レベル1のタイルマップ │ ├── level2_data.csv # レベル2のタイルマップ │ ├── ... └── pycache/ # Pythonキャッシュ


---

## クラス設計

### 1. Characterクラス
- **ファイル**: `character.py`
- **プロパティ**:
  - `char_type`: キャラクターの種類（プレイヤー、敵）。
  - `health`: キャラクターのライフ。
  - `score`: プレイヤーのスコア。
  - `animation_list`: アニメーションデータ。
  - `rect`: キャラクターの位置とサイズ。
- **メソッド**:
  - `move(dx, dy)`: キャラクターの移動。
  - `update()`: アニメーションと状態の更新。
  - `draw(surface)`: キャラクターの描画。

### 2. Weaponクラス
- **ファイル**: `weapon.py`
- **プロパティ**:
  - `image`: 武器の画像。
  - `arrow_image`: 矢の画像。
- **メソッド**:
  - `update(player)`: 矢の発射処理。
  - `draw(surface)`: 武器の描画。

### 3. Itemクラス
- **ファイル**: `items.py`
- **プロパティ**:
  - `item_type`: アイテムの種類（コイン、ポーション）。
  - `animation_list`: アイテムのアニメーションデータ。
  - `rect`: アイテムの位置とサイズ。
- **メソッド**:
  - `update(player)`: プレイヤーとの衝突判定と効果適用。
  - `draw(surface)`: アイテムの描画。

### 4. Worldクラス
- **ファイル**: `world.py`
- **プロパティ**:
  - `tile_list`: タイル画像のリスト。
- **メソッド**:
  - `process_data(data, tile_list, item_images)`: レベルデータの処理。
  - `draw(surface)`: ワールドの描画。

---

## 今後の改善案
1. **敵のAI強化**:
   - 敵がプレイヤーを追尾するロジックを追加。
2. **新しいアイテムの追加**:
   - 攻撃力アップやスピードアップなどのアイテムを追加。
3. **複数レベルの実装**:
   - レベルクリア後に次のレベルへ進む機能を追加。
4. **スコア保存機能**:
   - ハイスコアを保存して表示する機能を追加。